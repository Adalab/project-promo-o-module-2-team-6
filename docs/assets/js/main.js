"use strict";const allInput=document.querySelectorAll(".js-input"),allRadio=document.querySelectorAll(".js-radio"),inputColors=document.querySelectorAll(".js-palette"),namePreview=document.querySelector(".js-preview-name"),jobPreview=document.querySelector(".js-preview-job"),emailPreview=document.querySelector(".js-preview-email"),phonePreview=document.querySelector(".js-preview-phone"),linkedinPreview=document.querySelector(".js-preview-linkedin"),githubPreview=document.querySelector(".js-preview-github"),textError=document.querySelector(".js-text-error"),createButton=document.querySelector(".js-submit"),createLink=document.querySelector(".js-link-card"),createButtonTw=document.querySelector(".js-twitter"),resetButton=document.querySelector(".js-reset");let data={name:"",job:"",email:"",phone:"",linkedin:"",github:"",photo:"",palette:1};function handlerClickCollapsable(e){const t=document.querySelector(".form__design"),r=document.querySelector(".form__fill"),a=document.querySelector(".form__share");t.classList.add("collapsed"),r.classList.add("collapsed"),a.classList.add("collapsed");const o=document.querySelectorAll(".form__title--chevron");for(const e of o)e.classList.add("fa-chevron-down"),e.classList.remove("fa-chevron-up");const n=e.currentTarget.querySelector(".form__title--chevron");n.classList.add("fa-chevron-up"),n.classList.remove("fa-chevron-down"),e.currentTarget.parentNode.classList.toggle("collapsed")}const collapsableDesign=document.querySelector(".js-design__title");collapsableDesign.addEventListener("click",handlerClickCollapsable);const collapsableFill=document.querySelector(".js-fill__title");collapsableFill.addEventListener("click",handlerClickCollapsable);const collapsableShare=document.querySelector(".js-share__title");collapsableShare.addEventListener("click",handlerClickCollapsable);const getFromLocalStorage=()=>{const e=localStorage.getItem("userData");null!==e&&(data=JSON.parse(e),autoCompleteInputs(),renderPreview(),handleColorChange(),handleChangeInputs())};function autoCompleteInputs(){for(const e of allInput)e.value=data[e.name];for(const e of allRadio){parseInt(e.value)===parseInt(data.palette)&&(e.checked=!0)}}const setInLocalStorage=()=>{const e=JSON.stringify(data);localStorage.setItem("userData",e)},deleteFromLocalStorage=()=>{localStorage.removeItem("userData")};function handleWriteInput(e){const t=e.target.name,r=e.target.value;data[t]=r,renderPreview(),setInLocalStorage(),handleResetShare()}function handleWriteRadio(e){const t=e.target.value;data.palette=parseInt(t),setInLocalStorage(),handleResetShare(),handleChangeInputs()}function renderItemText(e,t,r){t.innerHTML=""===e?r:e}function renderItemLink(e,t,r){""===e?(t.href="#",t.target="_self"):(t.href=r,t.target="_blank")}function renderPreview(){renderItemText(data.name,namePreview,"Nombre Apellido"),renderItemText(data.job,jobPreview,"Front-End developer"),renderItemLink(data.email,emailPreview,"mailto:"+data.email),renderItemLink(data.linkedin,linkedinPreview,"https://www.linkedin.com/in/"+data.linkedin),renderItemLink(data.github,githubPreview,"https://github.com/"+data.github),renderItemLink(data.phone,phonePreview,"tel:"+data.phone)}for(const e of allInput)e.addEventListener("keyup",handleWriteInput);for(const e of allRadio)e.addEventListener("click",handleWriteRadio);function colorChange(e,t,r,a){const o=document.querySelectorAll(".js-icons"),n=document.querySelectorAll(".js-border"),l=document.querySelector(".js-borderleft");if(e.value===t&&e.checked){namePreview.classList.add("text"+t),namePreview.classList.remove("text"+r,"text"+a);for(const e of o)e.classList.add("icon"+t),e.classList.remove("icon"+r,"icon"+a);for(const e of n)e.classList.add("border-icon"+t),e.classList.remove("border-icon"+r,"border-icon"+a);l.classList.add("border-text"+t),l.classList.remove("border-text"+r,"border-text"+a)}}function handleColorChange(){const e=document.querySelectorAll(".js-radio");for(const t of e)colorChange(t,"1","2","3"),colorChange(t,"2","1","3"),colorChange(t,"3","2","1")}for(const e of inputColors)e.addEventListener("click",handleColorChange);getFromLocalStorage();const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result}function handleChangeInputs(){let e=!0;for(const t of allInput)t.required&&""===t.value&&e&&(e=!1);createButton.disabled=!e,showErrorMesage(e)}function showErrorMesage(e){textError.innerHTML=e?"":'¡Hola! Los campos con <span class="required">* </span>son obligatorios.'}fileField.addEventListener("change",getImage);for(const e of allInput)e.addEventListener("change",handleChangeInputs);function handleCreateCard(e){e.preventDefault(),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",body:JSON.stringify(data),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{createLink.innerHTML=`<h3 class="form__card--title">La tarjeta ha sido creada:</h3> <a class="form__card--link" href="${e.cardURL}"target="_blank" title="URL card">${e.cardURL}</a>`,createButtonTw.innerHTML=`<a class="form__twitter--link" href="https://twitter.com/intent/tweet?text=¡Hola!%20Mira%20mi%20tarjeta%20de%20presentación%20de%20Awesome%20Cards%20&url=${e.cardURL}" target="_blank" title="twitter"><i class="form__twitter--icon fab fa-twitter"></i>Compartir en twitter</a>`}),createButton.disabled=!0}function handleResetCard(){document.querySelector(".js-form").reset(),data.name="",data.job="",data.email="",data.phone="",data.linkedin="",data.github="",data.photo="",data.palette=1,renderPreview(),handleColorChange(),profileImage.style.backgroundImage="",profilePreview.style.backgroundImage="",handleResetShare(),createButton.disabled=!0,localStorage.removeItem("userData")}function handleResetShare(){createLink.innerHTML="",createButtonTw.innerHTML=""}createButton.addEventListener("click",handleCreateCard),resetButton.addEventListener("click",handleResetCard);